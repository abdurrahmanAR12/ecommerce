<%- include('header.ejs') %>
  <%- include('navbar.ejs') %>

    <body>
      <div id='product' data-id=<%=product.id %>></div>
      <% if(product.Pic.length>1){ %>
        <div id="gallery" style="width: 100%;margin-top: 4em;" class="relative w-full" data-carousel="slide">
          <% }else{%>
            <div id="gallery" style="width: 100%;margin-top: 4em;" class="relative w-full" data-carousel="slide">
              <% }%>
                <% let buttons=false; %>
                  <div class="relative h-56 overflow-hidden rounded-lg md:h-96">
                    <% if(product.Pic.length>1){ %>
                      <% buttons=true; %>
                        <% for(let pic of product.Pic){ %>
                          <div class="hidden duration-700 ease-in-out" data-carousel-item>
                            <img src=<%=pic%>
                            class="absolute block max-w-full h-auto -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2"
                            alt="">
                          </div>
                          <% } %>
                  </div>
                  <% }else { %>
                    <img src=<%=product.Pic[0]%>
                    class="absolute block max-w-full h-auto -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2" alt="">
                    <% } %>
                      <% if(buttons) {%>
                        <button type="button"
                          class="absolute top-0 left-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none"
                          data-carousel-prev>
                          <span
                            class="inline-flex items-center justify-center bg-gray-600 w-10 h-10 rounded-full dark:bg-gray-800/30 group-focus:ring-4 group-focus:ring-white dark:group-focus:ring-gray-800/70 group-focus:outline-none">
                            <svg class="w-4 h-4 text-white dark:text-gray-800" aria-hidden="true"
                              xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 6 10">
                              <path stroke="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M5 1 1 5l4 4" />
                            </svg>
                            <span class="sr-only">Previous</span>
                          </span>
                        </button>
                        <button type="button"
                          class="absolute top-0 right-0 z-30  flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none"
                          data-carousel-next>
                          <span
                            class="inline-flex items-center justify-center w-10 h-10 bg-gray-600 rounded-full group-focus:ring-4 group-focus:ring-white dark:group-focus:ring-gray-800/70 group-focus:outline-none">
                            <svg class="w-4 h-4 text-white dark:text-gray-800" aria-hidden="true"
                              xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 6 10">
                              <path stroke="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="m1 9 4-4-4-4" />
                            </svg>
                            <span class="sr-only">Next</span>
                          </span>
                        </button>
                        <% }%>
            </div>
            <div class="md:flex md:w-full items-start justify-center py-12 2xl:px-20 md:px-6 px-4">
              <div class="xl:w-96 md:w-full lg:ml-8 md:mt-0 mt-6">
                <div class="border-b border-gray-200 pb-6">
                  <p class="text-sm leading-none text-gray-600 dark:text-gray-300 ">
                    <%= product.Category %>
                  </p>
                  <h1
                    class="lg:text-2xl text-xl font-semibold lg:leading-6 leading-7 text-gray-800 dark:text-white mt-2">
                    <%= product.Name %>
                  </h1>
                </div>
                <div class="py-4 border-b border-gray-200 flex items-center justify-between">
                  <p class="text-base leading-4 text-gray-800 dark:text-gray-300">Availablillity</p>
                  <div class="flex items-center justify-center">
                    <% if(product.Stock>0){ %>
                      <p class="text-sm leading-none text-gray-600 dark:text-gray-300">Available</p>
                      <% } else{ %>
                        <p class="text-sm leading-none text-pink-800 dark:text-gray-300">Not Available</p>
                        <% } %>
                          <div class="w-6 h-6 bg-gradient-to-b from-gray-900 to-indigo-500 ml-3 mr-4 cursor-pointer">
                          </div>
                  </div>
                </div>
                <div class="py-4 border-b border-gray-200 flex items-center justify-between">
                  <p class="text-base leading-4 text-gray-800 dark:text-gray-300">Stock</p>
                  <div class="flex items-center justify-center">
                    <% if(product.Stock>0){ %>
                      <p class="text-sm leading-none text-gray-600 dark:text-gray-300">
                        <%= product.Stock %>
                      </p>
                      <% } else{ %>
                        <p class="text-sm leading-none text-pink-800 dark:text-gray-300">
                          <%= product.Stock %>
                        </p>
                        <% } %>
                          <div class="w-6 h-6 bg-gradient-to-b from-gray-900 to-indigo-500 ml-3 mr-4 cursor-pointer">
                          </div>
                  </div>
                </div>
                <div class="py-4 border-b border-gray-200 flex items-center justify-between">
                  <p class="text-base leading-4 text-gray-800 dark:text-gray-300">Price</p>
                  <div class="flex items-center justify-center">
                    <p class="text-sm leading-none text-gray-600 dark:text-gray-300 mr-3">Rs: <%= product.Price %>
                    </p>
                  </div>
                </div>
                <script>
                  window.q = 1;
                  window.encDec = function encDec(stock, type) {
                    if (type == "d") {
                      if (window.q > 1) window.q -= 1;
                    }
                    else {
                      if (window.q < stock)
                        window.q += 1;
                    }
                    document.getElementById("quantity").innerText = window.q;
                  }
                </script>
                <div class="py-4 border-b border-gray-200 flex items-center justify-between">
                  <p class="text-base leading-4 text-gray-800 dark:text-gray-300">How much to buy? </p>
                  <div class="flex items-center justify-center">
                    <button data-stock=<%=product.Stock %> id="dec" class="py-1 px-1 mx-2 bg-gray-200 hover:bg-gray-300
                      mx-1 rounded-md">
                      <svg class="w-3.5 h-3.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="16"
                        height="16" fill="currentColor" class="bi bi-dash" viewBox="0 0 18 18">
                        <path d="M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8z" />
                      </svg>
                    </button>
                    <p id="quantity" class="text-sm leading-none text-gray-600 dark:text-gray-300 mr-3">1</p>
                    <button data-stock=<%=product.Stock %> id="inc" class="py-1 px-1 bg-gray-200 mx-2 hover:bg-gray-300
                      rounded-md">
                      <svg class="w-3.5 h-3.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                        viewBox="0 0 18 18">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M9 1v16M1 9h16" />
                      </svg>
                    </button>
                    <script>
                      let btn = document.getElementById("inc"),
                        btn2 = document.getElementById("dec")
                      btn.addEventListener("click", e => {
                        window.encDec(btn.getAttribute("data-stock"), "i")
                      })
                      btn2.addEventListener("click", e => {
                        window.encDec(btn2.getAttribute("data-stock"), "d")
                      });
                    </script>
                  </div>
                </div>
                <div class="w-md flex items-center">
                  <button btn-order data-product-id=<%=product.id %>
                    class="dark:bg-white dark:text-gray-900 my-2 rounded-md dark:hover:bg-gray-100 focus:outline-none
                    focus:ring-2 focus:ring-offset-2 focus:ring-gray-800 text-base flex items-center justify-center
                    leading-none text-white bg-gray-800 w-full py-4 hover:bg-gray-700 focus:outline-none">
                    Order now
                    <svg class="text-gray-300 mx-2 dark:text-white cursor-pointer" width="6" height="10"
                      viewBox="0 0 6 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M1 1L5 5L1 9" stroke="currentColor" stroke-width="1.25" stroke-linecap="round"
                        stroke-linejoin="round" />
                    </svg>
                  </button>
                  <script>
                    let btnOrder = document.querySelector("[btn-order]");
                    btnOrder.addEventListener("click", () => {
                      let att = btnOrder.getAttribute("data-product-id")
                      addToCart(att, window.q);
                      location.pathname = "/cart";
                    });
                  </script>
                  <button id="add" data-product-id=<%=product.id %>
                    class="dark:bg-white mx-2 dark:text-gray-900 rounded-md dark:hover:bg-gray-100 focus:outline-none
                    focus:ring-2
                    focus:ring-offset-2 focus:ring-gray-800 text-base flex items-center justify-center leading-none
                    text-white
                    bg-gray-800 w-full py-4 hover:bg-gray-700 focus:outline-none">
                    Add to Cart
                    <svg class="w-3.5 h-3.5 mx-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                      viewBox="0 0 18 18">
                      <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M9 1v16M1 9h16" />
                    </svg>
                  </button>
                  <script>
                    let add = document.getElementById("add");
                    add.addEventListener("click", e => {
                      let att = add.getAttribute("data-product-id");
                      addToCart(att, window.q);
                    })
                  </script>
                </div>

                <p
                  class="xl:pr-48 text-base my-2 lg:leading-tight leading-normal text-gray-600 dark:text-gray-300 mt-7">
                  <%= product.Description %>
                </p>
                <div main-product-details class="bg-gray-100 hidden p-1 my-2 rounded-md">
                  <h2 class="text-2xl my-2 text-black">Additional Product details:</h2>
                  <div id="about" class="my-3"></div>
                  <div id="features" class="hidden">
                    <div class="hidden items-center">
                      <h2 class="text-base text-gray-500">Features:</h2>
                      <div class="border-b w-full mx-4"></div>
                    </div>
                  </div>
                  <div id="colors" class="hidden flex items-center">
                    <h2 class="text-base text-gray-500">Colors:</h2>
                  </div>
                  <div id="other"></div>
                  <div id="sizes" class="hidden flex my-3 items-center">
                    <h2 class="text-base text-gray-500">Available Sizes:</h2>
                  </div>
                  <div id="tags" class="hidden flex my-3 items-center">
                    <h2 class="text-base text-gray-500">Tags:</h2>
                  </div>

                  <script>
                    let about = document.getElementById("about"),
                      features = document.getElementById("features"),
                      colors = document.getElementById("colors"),
                      others = document.getElementById("other"),
                      sizes = document.getElementById("sizes");
                    fetch("/api/products/get/" + document.getElementById("product").getAttribute("data-id")).then(res => res.json()).then(product => {
                      for (let field of product.OverView) {
                        document.querySelector("[main-product-details]").classList.remove("hidden");
                        if (field.type === "text") {
                          about.classList.remove("hidden");
                          createAbout(field.text);
                        }
                        else if (field.tags) {
                          document.getElementById("tags").classList.remove("hidden")
                          createTags(field.tags);
                        }
                        else if (field.type === "feature") {
                          features.classList.remove("hidden");
                          createFeature(field.text);
                        }
                        else if (field.type === "size") {
                          sizes.classList.remove("hidden");
                          createSize(field.text);
                        }
                        else if (field.type === "color") {
                          colors.classList.remove("hidden");
                          createColor(field.text);
                        }
                      }
                    });

                    function createTags(tags) {
                      for (let tag of tags) {
                        let a = document.createElement("a");
                        a.className = "text-gray-800 mx-2 hover:text-gray-400 text-base border-b";
                        a.href = `/search/key=${tag}&page=1`
                        a.innerText = tag;
                        document.getElementById("tags").appendChild(a);
                      }
                    }

                    function createOther(obj) {
                      let p = document.createElement("p");
                      p.innerText = obj.name + " : " + obj.text;
                      p.className = "text-base text-gray-500";
                      others.appendChild(p);
                    }

                    function createAbout(text) {
                      let p = document.createElement("p");
                      p.innerText = text;
                      p.className = "text-base text-gray-500";
                      about.appendChild(p);
                    }

                    function createFeature(text) {
                      let p = document.createElement("li");
                      p.className = "text-base mx-2 text-gray-500";
                      p.innerText = "✔   " + text;
                      about.appendChild(p);
                    }

                    function createSize(text) {
                      let radio = document.createElement("radio");
                      radio.className = "block mx-2 text-gray-300";
                      radio.name = "size";
                      radio.innerText = text;
                      sizes.appendChild(radio);
                    }

                    function createColor(text) {
                      let radio = document.createElement("radio");
                      radio.className = "block text-gray-300";
                      radio.name = "size";
                      colors.appendChild(radio);
                    }
                  </script>
                </div>
                <div class="">
                  <p class="text-2xl text-gray-500">Our terms and conditions about every single Product:</p>
                  <div class="border-t border-b py-4 mt-7 border-gray-200">
                    <div data-menu class="flex justify-between items-center cursor-pointer">
                      <p class="text-base leading-4 text-gray-800 dark:text-gray-300">Shipping and returns</p>
                      <button
                        class="cursor-pointer focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-400 rounded"
                        role="button" aria-label="show or hide">
                        <svg class="transform text-gray-300 dark:text-white" width="10" height="6" viewBox="0 0 10 6"
                          fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M9 1L5 5L1 1" stroke="currentColor" stroke-width="1.25" stroke-linecap="round"
                            stroke-linejoin="round" />
                        </svg>
                      </button>
                    </div>
                    <div class="hidden pt-4 text-base leading-normal pr-12 mt-4 text-gray-600 dark:text-gray-300"
                      id="sect">You will be responsible for paying for your own shipping costs for returning your
                      item. Shipping costs are nonrefundable
                    </div>
                  </div>
                </div>
                <div>
                  <div class="border-b py-4 border-gray-200">
                    <div data-menu class="flex justify-between items-center cursor-pointer">
                      <p class="text-base leading-4 text-gray-800 dark:text-gray-300">Contact us</p>
                      <button
                        class="cursor-pointer focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-400 rounded"
                        role="button" aria-label="show or hide">
                        <svg class="transform text-gray-300 dark:text-white" width="10" height="6" viewBox="0 0 10 6"
                          fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M9 1L5 5L1 1" stroke="currentColor" stroke-width="1.25" stroke-linecap="round"
                            stroke-linejoin="round" />
                        </svg>
                      </button>
                    </div>
                    <div class="hidden pt-4 text-base leading-normal pr-12 mt-4 text-gray-600 dark:text-gray-300"
                      id="sect">If you have any questions on how to return your item to us, <a
                        class="text-gray-600 hover:text-blue-800" href="/contact_us">contact us</a>.</div>
                  </div>
                </div>
              </div>
            </div>
            <script>
              let elements = document.querySelectorAll("[data-menu]");
              for (let i = 0; i < elements.length; i++) {
                let main = elements[i];
                main.addEventListener("click", function () {
                  let element = main.parentElement.parentElement;
                  let andicators = main.querySelectorAll("svg");
                  let child = element.querySelector("#sect");
                  child.classList.toggle("hidden");
                  andicators[0].classList.toggle("rotate-180");
                });
              }
            </script>

    </body>

    <%- include('headerEnd.ejs') %>